version: '3'

tasks:
  gen:
    cmds:
      - go generate ./...

  doc-gen:
    cmds:
      - |
        printf 'go doc\n```text\n' > "README.md"
        {
          for p in $(go list ./...); do
            printf "==== %s ====\n" "$p"
            go doc -all "$p"
            printf "\n\n"
          done
        } >> "README.md"
        printf '\n```\n' >> "README.md"
